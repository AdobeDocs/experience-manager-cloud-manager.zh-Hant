---
title: 設定生產管道
description: 了解如何使用 Cloud Manager 建立和設定生產管道，以部署程式碼。
exl-id: d489fa3c-df1e-480b-82d0-ac8cce78a710
source-git-commit: 8e2c57d2594691e7fb18d8a538caa9b54a26b6bb
workflow-type: tm+mt
source-wordcount: '1248'
ht-degree: 48%

---


# 設定生產管道 {#configuring-production-pipelines}

了解如何使用 Cloud Manager 建立和設定生產管道，以部署程式碼。 如果您想先瞭解有關在Cloud Manager中管道如何運作的更多概念性概觀，請參閱[CI/CD管道](/help/overview/ci-cd-pipelines.md)。

## 概觀 {#overview}

使用&#x200B;**管道設定**&#x200B;圖磚 (在 [!UICONTROL Cloud Manager] 中)，您可建立兩種不同類型的管道。

* **生產管道** — 生產管道是一個專門建置的管道，由一系列精心安排的步驟組成，以將原始程式碼從您的Git存放庫一路帶入生產環境。
* **非生產管道** - 非生產管道主要用於執行程式碼品質掃描或將原始程式碼部署到開發環境中。

本文件會專注於生產管道。如需有關如何設定非生產管道的詳細資訊，請參閱檔案[設定非生產管道](/help/using/non-production-pipelines.md)。

**部署管理員**&#x200B;的角色即負責設定管道。管道設定包括：

1. 定義啟動管道的觸發器。
1. 定義控制生產部署的參數。
1. 設定效能測試參數。

>[!NOTE]
>
>在和管道相關的Git存放庫具有至少一個分支且[程式設定](/help/getting-started/program-setup.md)完成之前，無法設定管道。

## 新增生產管道 {#adding-production-pipeline}

使用[!UICONTROL Cloud Manager] UI設定好方案並擁有至少一個環境後，您就可以著手新增生產管道了。

1. 在 [my.cloudmanager.adobe.com](https://my.cloudmanager.adobe.com/) 登入 Cloud Manager 並選取適當的組織和方案。

1. 從&#x200B;**方案總覽**&#x200B;頁面瀏覽至&#x200B;**管道**&#x200B;卡。

1. 按一下&#x200B;**+新增**，然後選取&#x200B;**新增生產管道**。

   ![新增生產管道](/help/assets/configure-pipelines/add-prod1.png)

1. 此&#x200B;**新增生產管道**&#x200B;對話框會開啟&#x200B;**設定**&#x200B;索引標籤，在此會提供幾個必須定義的管道選項。這些選項會被分組到可摺疊的區段中，並在以下步驟中進行說明。

   1. 在&#x200B;**管道名稱**&#x200B;欄位中為您的管道提供描述性名稱。

   1. 在&#x200B;**Source程式碼**&#x200B;區段下，您可定義管道從何處擷取其處理的程式碼。

      * **存放庫** — 定義管道應該擷取程式碼的Git存放庫。

      >[!TIP]
      >
      >如要了解如何在 Cloud Manager 中新增和管理存放庫，請參閱文件：[方案設定](/help/getting-started/program-setup.md)。

      * **Git分支** — 定義所選管道中應該從哪個分支擷取程式碼。
      * **程式碼位置** — 定義管道應該從所選存放庫的分支中擷取程式碼的路徑。

      ![定義管道的存放庫](/help/assets/configure-pipelines/add-prod2.png)

   1. 在&#x200B;**環境**&#x200B;區段下，您可以定義部署的觸發器以及應如何在每個環境中推出部署。

      1. 在&#x200B;**中繼**&#x200B;區段中，您可以定義如何將管道推出至您的中繼環境。

         * **部署觸發器** - 您有以下選項可定義部署觸發器，以啟動管道。

            * **手動** — 使用Cloud Manager UI手動啟動管道。
            * **在Git變更上** — 只要將認可新增到已設定的Git分支，就會啟動CI/CD管道。 使用此選項，您仍然可以在需要時手動啟動管道。

         * **重要量度失敗行為** - 在管道設定或編輯期間，部署管理員可選擇對任何品質閘道中遭遇重要失敗時的管道行為進行定義。可使用的選項包括：

            * **每次都詢問** — 預設設定，需要對任何重要失敗進行手動介入。
            * **立即失敗** — 每當重要失敗發生時，就會取消管道。 它正在模擬使用者手動拒絕每個失敗。
            * **立即繼續** — 每當重要失敗發生時，管道就會自動繼續。 它正在模擬使用者手動核准每次失敗。

         ![部署觸發器](/help/assets/configure-pipelines/add-prod3.png)

         * **部署選項** - 您可加速特定部署任務。

            * **在中繼部署後核准** - 此核准會在部署至中繼環境之後發生，然後才會進行任何測試。否則，會在生產部署之前進行核准，這會在所有測試完成後完成。

            * **略過負載平衡器變更** - 不進行負載平衡器變更。

         ![中繼部署選項](/help/assets/configure-pipelines/add-prod4.png)

         * **Dispatcher設定** - **部署管理員**&#x200B;角色可設定在執行管道時失效或從AEM Dispatcher快取中排清的一組內容路徑。 在部署任何內容套件後，這些快取動作會在部署管道步驟中執行。 這些設定會使用標準的 AEM Dispatcher 行為。若要設定，請執行下列動作：

            1. **路徑**&#x200B;下會提供內容路徑。
            1. 在&#x200B;**類型**&#x200B;下，選取在該路徑將採取的操作。

               * **排清** - 執行快取刪除。
               * **失效** - 執行快取失效，類似於將內容從製作執行個體啟動至發佈執行個體的情況。

            1. 按一下&#x200B;**新增路徑**，即可新增您指定的路徑。您在每個環境最多可新增 100 個路徑。

         ![Dispatcher 設定](/help/assets/configure-pipelines/dispatcher-stage.png)

         >[!TIP]
         >
         >一般而言，最好使用無效操作，但在某些情況下可能需要排清，尤其是在使用 AEM HTML 用戶端資料庫時。

      1. 在&#x200B;**生產**&#x200B;區段中，您可以定義如何將管道推出至您的生產環境。

         * **部署選項** - 您可定義控制生產部署的參數。

            * **使用上線核准** — 具有&#x200B;**企業所有者**、**專案管理員**&#x200B;或&#x200B;**部署管理員**&#x200B;角色的使用者，必須透過[!UICONTROL Cloud Manager] UI手動核准部署。
            * **已排程** — 在生產部署之前暫停管道，以允許對其進行排程。 如果選取此選項，管道將在部署到中繼環境後暫停，並提示使用者應採取的操作。
               * **`Now`** — 立即部署到生產環境，有效地完成管道。
               * **日期** — 讓使用者排程應完成部署的時間。
               * **停止執行** — 中止到生產環境的部署。

           >[!TIP]
           >
           >請參閱[程式碼部署](/help/using/code-deployment.md)，瞭解如何設定部署排程或立即執行管道。

            * **使用CSE監督** — 如果選取此選項，則CSE （客戶成功工程師）會參與以開始實際部署。 在啟用此選項的情況下建立或編輯管道時，**部署管理員**&#x200B;角色會有以下選項。

               * **任何CSE** — 允許任何可用的CSE開始部署。
               * **我的CSE** — 僅允許指派給客戶的特定CSE開始部署。 如果指派的CSE沒有空，此選項也適用於CSE的指定後援。

           ![生產部署選項](/help/assets/configure-pipelines/prod-deploymentoptions.png)

         * **Dispatcher設定** — 為您的生產環境定義Dispatcher設定。 這些選項和中繼環境的選項相同。

1. 按一下&#x200B;**繼續**&#x200B;以進入&#x200B;**中繼測試**&#x200B;標籤，您可在此設定AEM Sites和AEM Assets的效能測試（視您已授權的產品而定）。

   >[!TIP]
   >
   >請參閱[程式碼品質測試](/help/using/code-quality-testing.md#performance-testing)，以瞭解&#x200B;**中繼測試**&#x200B;索引標籤上可用選項的詳細資訊。

   1. 在&#x200B;**網站內容傳遞/分散式負載權數**&#x200B;區段中，您可以根據三個頁面集之間的頁面請求權重來設定網站效能測試。 您可以視需要啟用或停用頁面集。

      * **熱門的即時頁面**
      * **其他即時頁面**
      * **新頁面**

      ![網站負載權數](/help/assets/configure-pipelines/add-prod5.png)

   1. 在&#x200B;**Assets效能測試分佈**&#x200B;區段下，您可以定義影像和PDF的測試分佈並定義您自己的測試資產。

      * **影像** - 調整滑桿即可調整影像和 PDF 之間的測試劃分。
      * **PDF** - 調整滑桿即可調整影像和 PDF 之間的測試劃分。

      * 透過上傳來定義您自己的自訂資產。

         1. **格式** - 選擇您的自訂資產是否為影像的 PDF。
         1. **檔案名稱** - 使用檔案瀏覽器按鈕從您的本機電腦中選取影像。
         1. **新增測試檔案** - 按一下即可上傳您選取的資產。

      ![資產測試分佈](/help/assets/configure-pipelines/add-prod6.png)

1. 按一下&#x200B;**儲存**，即可完成新增生產管道。

## 後續步驟 {#the-next-steps}

設定好管道後，即可部署程式碼。 如需詳細資訊，請參閱[程式碼部署](/help/using/code-deployment.md)。

## 教學課程影片 {#video-tutorial-one}

該影片會提供管道建立流程的概觀，本文件對此有詳細說明。

>[!VIDEO](https://video.tv.adobe.com/v/26314/)
